<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>東京快閃 2025 | Muji Trip</title>
    
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>

    <!-- Google Fonts: Noto Sans TC (Text) & Roboto Mono (Numbers) -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500;700&family=Roboto+Mono:wght@400;500&display=swap" rel="stylesheet">

    <style>
        /* Muji Style Customization */
        :root {
            --bg-color: #f9f9f6; /* Washi Paper color */
            --primary: #44403c;  /* Stone 700 */
            --accent: #a8a29e;   /* Stone 400 */
            --danger: #b91c1c;   /* Muted Red */
        }
        body {
            font-family: 'Noto Sans TC', sans-serif;
            background-color: var(--bg-color);
            color: var(--primary);
            -webkit-tap-highlight-color: transparent;
        }
        .font-mono {
            font-family: 'Roboto Mono', monospace;
        }
        /* Custom Scrollbar for hidden look */
        .no-scrollbar::-webkit-scrollbar {
            display: none;
        }
        .no-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
        .card {
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
            border: 1px solid #e7e5e4; /* stone-200 */
        }
        .input-muji {
            background-color: #f5f5f4;
            border: none;
            border-bottom: 2px solid transparent;
            transition: border-color 0.3s;
        }
        .input-muji:focus {
            outline: none;
            border-bottom-color: #78716c;
        }
        /* Bottom Navigation Safe Area */
        .safe-bottom {
            padding-bottom: env(safe-area-inset-bottom);
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;
        const { 
            Calendar, MapPin, Wallet, List, Info, 
            Plane, Bed, Coffee, ShoppingBag, Camera, 
            ChevronRight, ExternalLink, Trash2, Plus, 
            Calculator, Sun, Phone, AlertTriangle 
        } = lucide;

        // --- DATA SECTION ---
        const TRIP_DATA = {
            dates: ["12/10", "12/11", "12/12", "12/13", "12/14"],
            hotel: {
                name: "Dormy Inn Ikebukuro",
                zhName: "天然温泉 豊穣の湯 ドーミーイン池袋",
                address: "東京都豊島区東池袋3-11-11",
                mapUrl: "https://www.google.com/maps/search/?api=1&query=Dormy+Inn+Ikebukuro",
                note: "訂單編號: (請參考附件) | 12/11-12/13"
            },
            flights: [
                { type: "去程", code: "UO624", time: "12/10 23:55 → 12/11 04:45", route: "HKG → HND T3" },
                { type: "回程", code: "UO629", time: "12/14 01:55 起飛", route: "HND T3 → HKG" }
            ],
            itinerary: [
                {
                    date: "12/10 (三)",
                    highlight: "出發日",
                    events: [
                        { time: "23:55", title: "香港出發", desc: "航班 UO624 / T3 報到", icon: "flight", important: true }
                    ]
                },
                {
                    date: "12/11 (四)",
                    highlight: "抵達 & 購物 & 展覽",
                    events: [
                        { time: "04:45", title: "抵達羽田", desc: "入境、領SIM卡、梳洗", icon: "flight" },
                        { time: "08:30", title: "巴士移動", desc: "利木津巴士前往池袋 (僅寄放行李)", icon: "bus" },
                        { time: "10:30", title: "東京車站購物", desc: "皇居長夾、BUTTER甜點、7-11取票(請參考附件)", icon: "shop", map: "東京駅" },
                        { time: "14:30", title: "Chiikawa Park", desc: "Sunshine City Annex 1F", icon: "shop" },
                        { time: "16:00", title: "Check-in", desc: "Dormy Inn 池袋", icon: "hotel" },
                        { time: "17:00", title: "展覽 (Gallery AaMo)", desc: "第1刷，錯開人潮", icon: "star", map: "Gallery AaMo" },
                        { time: "20:30", title: "溫泉 & 晚餐", desc: "池袋周邊覓食", icon: "food" }
                    ]
                },
                {
                    date: "12/12 (五)",
                    highlight: "核心展覽 & 賞秋景",
                    events: [
                        { time: "10:00", title: "展覽 (第2刷)", desc: "Gallery AaMo 上午場", icon: "star", map: "Gallery AaMo" },
                        { time: "12:00", title: "午餐", desc: "東京巨蛋周邊 → 移動至新宿", icon: "food" },
                        { time: "13:30", title: "新宿御苑", desc: "賞紅葉/銀杏", icon: "tree", map: "Shinjuku Gyoen" },
                        { time: "18:00", title: "Workman 購物", desc: "池袋太陽城店", icon: "shop" },
                        { time: "20:00", title: "溫泉", desc: "享受飯店設施", icon: "bath" }
                    ]
                },
                {
                    date: "12/13 (六)",
                    highlight: "明治神宮 & 最後採購",
                    events: [
                        { time: "11:00", title: "退房", desc: "寄放行李", icon: "hotel" },
                        { time: "11:30", title: "明治神宮", desc: "原宿午餐", icon: "tree", map: "Meiji Jingu" },
                        { time: "13:00", title: "池袋採購", desc: "P'PARCO, BIC CAMERA, ISEKI", icon: "shop" },
                        { time: "18:45", title: "前往機場", desc: "務必準時出發！", icon: "bus", important: true },
                        { time: "20:00", title: "機場報到", desc: "最後免稅店購物", icon: "flight" }
                    ]
                },
                {
                    date: "12/14 (日)",
                    highlight: "平安返家",
                    events: [
                        { time: "01:55", title: "起飛返港", desc: "UO629", icon: "flight" }
                    ]
                }
            ],
            checklist: [
                { id: 1, text: "護照 (有效期6個月以上)", checked: false },
                { id: 2, text: "Visit Japan Web 填寫截圖", checked: false },
                { id: 3, text: "SIM 卡 / 漫遊開通", checked: false },
                { id: 4, text: "日幣現金 / 信用卡", checked: false },
                { id: 5, text: "行動電源 & 充電線", checked: false },
                { id: 6, text: "Agoda 訂房憑證", checked: false },
                { id: 7, text: "7-11 取票代碼", checked: false },
                { id: 8, text: "常備藥品", checked: false }
            ],
            guides: [
                {
                    title: "明治神宮豆知識",
                    content: "明治神宮供奉明治天皇和昭憲皇太后。進入鳥居前請先鞠躬，參道中間是神明的通道，請靠兩側行走。手水舍洗手順序：左手→右手→漱口→左手→洗柄。",
                    tag: "文化"
                },
                {
                    title: "大眾溫泉禮儀",
                    content: "1. 入池前務必先將身體洗淨。\n2. 毛巾不可浸入浴池中 (可放在頭上)。\n3. 長髮請盤起。\n4. 進入更衣室前請擦乾身體。\n5. 身上有大片刺青者通常禁止進入 (Dormy Inn 規定請現場確認)。",
                    tag: "禮儀"
                },
                {
                    title: "新宿御苑",
                    content: "原為皇室庭園，橫跨新宿與澀谷。園內有日式庭園、英式風景庭園與法式整形庭園。禁止攜帶酒精飲料進入，也禁止使用遊樂器材。",
                    tag: "景點"
                }
            ]
        };

        // --- COMPONENTS ---

        // 1. Plan View (行程)
        const PlanView = () => {
            const [selectedDay, setSelectedDay] = useState(0);
            const dayData = TRIP_DATA.itinerary[selectedDay];

            const getIcon = (type) => {
                switch(type) {
                    case 'flight': return <Plane size={18} />;
                    case 'hotel': return <Bed size={18} />;
                    case 'food': return <Coffee size={18} />;
                    case 'shop': return <ShoppingBag size={18} />;
                    case 'bus': return <div className="text-xs font-bold">BUS</div>;
                    case 'tree': return <Sun size={18} />; // Nature
                    case 'star': return <div className="text-xs font-bold">★</div>;
                    default: return <Info size={18} />;
                }
            };

            return (
                <div className="pb-24">
                    {/* Date Selector */}
                    <div className="sticky top-0 bg-[#f9f9f6]/95 backdrop-blur-sm z-10 pt-4 pb-2 px-4 shadow-sm">
                        <div className="flex justify-between items-center mb-2">
                             <h2 className="text-xl font-bold tracking-widest text-stone-700">ITINERARY</h2>
                        </div>
                        <div className="flex gap-2 overflow-x-auto no-scrollbar">
                            {TRIP_DATA.itinerary.map((day, idx) => (
                                <button
                                    key={idx}
                                    onClick={() => setSelectedDay(idx)}
                                    className={`flex-shrink-0 px-4 py-2 rounded-md text-sm font-mono transition-colors ${
                                        selectedDay === idx 
                                        ? 'bg-stone-700 text-white' 
                                        : 'bg-white text-stone-500 border border-stone-200'
                                    }`}
                                >
                                    {day.date.split(' ')[0]}
                                </button>
                            ))}
                        </div>
                    </div>

                    {/* Day Content */}
                    <div className="px-4 mt-4 animate-fadeIn">
                        <div className="mb-4">
                            <p className="text-sm text-stone-500 font-mono">{dayData.date}</p>
                            <h3 className="text-2xl font-bold text-stone-800">{dayData.highlight}</h3>
                        </div>

                        {/* Special Info Cards (Hotel/Flight) - Only show on relevant days */}
                        {(selectedDay === 1 || selectedDay === 2) && (
                            <div className="card p-4 mb-6 border-l-4 border-stone-400 bg-white">
                                <div className="flex items-start gap-3">
                                    <Bed className="text-stone-600 mt-1" size={20} />
                                    <div>
                                        <p className="font-bold text-stone-800">{TRIP_DATA.hotel.name}</p>
                                        <p className="text-xs text-stone-500 mt-1">{TRIP_DATA.hotel.note}</p>
                                        <a href={TRIP_DATA.hotel.mapUrl} target="_blank" className="text-xs text-stone-400 underline mt-2 block">
                                            Open Google Maps
                                        </a>
                                    </div>
                                </div>
                            </div>
                        )}

                        <div className="relative border-l border-stone-300 ml-3 space-y-8 py-2">
                            {dayData.events.map((evt, idx) => (
                                <div key={idx} className="relative pl-6">
                                    {/* Timeline Dot */}
                                    <div className={`absolute -left-[9px] top-1 w-4 h-4 rounded-full border-2 border-[#f9f9f6] flex items-center justify-center ${evt.important ? 'bg-red-700' : 'bg-stone-400'}`}>
                                    </div>

                                    {/* Content */}
                                    <div className={`card p-4 transition-all ${evt.important ? 'border-red-100 bg-red-50/30' : ''}`}>
                                        <div className="flex justify-between items-start mb-1">
                                            <span className="font-mono text-sm font-bold text-stone-500 bg-stone-100 px-2 py-0.5 rounded">
                                                {evt.time}
                                            </span>
                                            <div className="text-stone-400">
                                                {getIcon(evt.icon)}
                                            </div>
                                        </div>
                                        <h4 className="font-bold text-lg text-stone-800 mb-1">{evt.title}</h4>
                                        <p className="text-sm text-stone-600 leading-relaxed">{evt.desc}</p>
                                        
                                        {evt.map && (
                                            <a 
                                                href={`https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(evt.map + " Tokyo")}`}
                                                target="_blank"
                                                className="mt-3 inline-flex items-center text-xs text-stone-500 border border-stone-300 px-3 py-1.5 rounded-full hover:bg-stone-50"
                                            >
                                                <MapPin size={12} className="mr-1" />
                                                Google Maps
                                            </a>
                                        )}
                                    </div>
                                </div>
                            ))}
                        </div>
                    </div>
                </div>
            );
        };

        // 2. Guide View (導覽)
        const GuideView = () => (
            <div className="px-4 py-6 pb-24">
                <h2 className="text-xl font-bold tracking-widest text-stone-700 mb-6">GUIDE</h2>
                
                <div className="space-y-6">
                    {TRIP_DATA.guides.map((guide, idx) => (
                        <div key={idx} className="card overflow-hidden">
                            <div className="bg-stone-100 px-4 py-2 border-b border-stone-200 flex justify-between items-center">
                                <span className="font-bold text-stone-700">{guide.title}</span>
                                <span className="text-[10px] bg-stone-300 text-white px-2 py-0.5 rounded-full">{guide.tag}</span>
                            </div>
                            <div className="p-4">
                                <p className="text-sm text-stone-600 leading-7 whitespace-pre-line text-justify">
                                    {guide.content}
                                </p>
                            </div>
                        </div>
                    ))}

                    {/* Embedded Map Example - Sunshine City */}
                    <div className="card p-2 mt-8">
                        <div className="mb-2 px-2 pt-2 font-bold text-sm text-stone-700">池袋 Sunshine City</div>
                        <iframe 
                            width="100%" 
                            height="200" 
                            frameBorder="0" 
                            scrolling="no" 
                            marginHeight="0" 
                            marginWidth="0" 
                            src="https://www.openstreetmap.org/export/embed.html?bbox=139.7150%2C35.7280%2C139.7220%2C35.7320&amp;layer=mapnik&amp;marker=35.7295%2C139.7185" 
                            className="rounded bg-stone-100"
                        ></iframe>
                    </div>
                </div>
            </div>
        );

        // 3. Wallet View (記帳) - Complex logic
        const WalletView = () => {
            const [items, setItems] = useState([]);
            const [inputName, setInputName] = useState("");
            const [inputAmount, setInputAmount] = useState(""); // String for calculation
            const [exchangeRate, setExchangeRate] = useState(0.052); // JPY to HKD
            const [showRateInput, setShowRateInput] = useState(false);
            
            // Load from LocalStorage
            useEffect(() => {
                const savedItems = localStorage.getItem('tokyo2025_wallet');
                const savedRate = localStorage.getItem('tokyo2025_rate');
                if (savedItems) setItems(JSON.parse(savedItems));
                if (savedRate) setExchangeRate(parseFloat(savedRate));
            }, []);

            // Save to LocalStorage
            useEffect(() => {
                localStorage.setItem('tokyo2025_wallet', JSON.stringify(items));
            }, [items]);

            const handleRateChange = (e) => {
                const rate = parseFloat(e.target.value);
                setExchangeRate(rate);
                localStorage.setItem('tokyo2025_rate', rate);
            };

            const calculateAmount = () => {
                try {
                    // Safe evaluation of simple math
                    // Remove anything that isn't a number or operator
                    const sanitized = inputAmount.replace(/[^0-9+\-*/.]/g, '');
                    const result = Function('"use strict";return (' + sanitized + ')')();
                    return result;
                } catch (e) {
                    return 0;
                }
            };

            const handleAddItem = (imgBase64 = null) => {
                if (!inputName || !inputAmount) return;
                
                const finalAmount = calculateAmount();
                
                const newItem = {
                    id: Date.now(),
                    name: inputName,
                    amountJPY: finalAmount,
                    amountHKD: (finalAmount * exchangeRate).toFixed(1),
                    date: new Date().toLocaleDateString(),
                    image: imgBase64
                };
                
                setItems([newItem, ...items]);
                setInputName("");
                setInputAmount("");
            };

            const handlePhotoUpload = (e) => {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = (event) => {
                        const img = new Image();
                        img.onload = () => {
                            // Resize logic
                            const canvas = document.createElement('canvas');
                            const ctx = canvas.getContext('2d');
                            const MAX_WIDTH = 600;
                            let width = img.width;
                            let height = img.height;

                            if (width > MAX_WIDTH) {
                                height *= MAX_WIDTH / width;
                                width = MAX_WIDTH;
                            }
                            canvas.width = width;
                            canvas.height = height;
                            ctx.drawImage(img, 0, 0, width, height);
                            const dataUrl = canvas.toDataURL('image/jpeg', 0.6); // Compress
                            handleAddItem(dataUrl);
                        };
                        img.src = event.target.result;
                    };
                    reader.readAsDataURL(file);
                }
            };

            const totalJPY = items.reduce((sum, item) => sum + Number(item.amountJPY), 0);
            const totalHKD = (totalJPY * exchangeRate).toFixed(0);

            return (
                <div className="px-4 py-6 pb-24">
                    <div className="flex justify-between items-end mb-6">
                        <h2 className="text-xl font-bold tracking-widest text-stone-700">WALLET</h2>
                        <div className="text-right" onClick={() => setShowRateInput(!showRateInput)}>
                            <span className="text-xs text-stone-400 font-mono block">匯率: {exchangeRate}</span>
                            <span className="text-2xl font-mono font-bold text-stone-800">HK${totalHKD}</span>
                        </div>
                    </div>

                    {showRateInput && (
                        <div className="card p-3 mb-4 bg-stone-100 animate-fadeIn">
                            <label className="text-xs text-stone-500 block mb-1">JPY to HKD Rate</label>
                            <input 
                                type="number" 
                                step="0.001"
                                value={exchangeRate}
                                onChange={handleRateChange}
                                className="w-full p-2 rounded bg-white font-mono"
                            />
                        </div>
                    )}

                    {/* Input Area */}
                    <div className="card p-4 mb-6 sticky top-4 z-20 shadow-lg border-stone-200">
                        <div className="flex gap-2 mb-3">
                            <input 
                                type="text" 
                                placeholder="品項 (如: 拉麵)" 
                                className="flex-1 input-muji p-2 rounded text-stone-700"
                                value={inputName}
                                onChange={(e) => setInputName(e.target.value)}
                            />
                        </div>
                        <div className="flex gap-2 mb-3">
                            <input 
                                type="text" 
                                placeholder="金額 (支援算式: 1000+200)" 
                                className="flex-1 input-muji p-2 rounded font-mono text-lg"
                                value={inputAmount}
                                onChange={(e) => setInputAmount(e.target.value)}
                            />
                        </div>
                        <div className="flex justify-between items-center text-xs text-stone-400 font-mono h-4 mb-2">
                            {inputAmount && <span>預覽: ¥{calculateAmount()}</span>}
                        </div>

                        <div className="flex gap-2">
                            <label className="flex-1 bg-stone-200 text-stone-600 rounded-md py-3 flex items-center justify-center cursor-pointer active:scale-95 transition-transform">
                                <Camera size={20} />
                                <span className="ml-2 text-sm font-medium">拍照存</span>
                                <input type="file" accept="image/*" capture="environment" className="hidden" onChange={handlePhotoUpload} />
                            </label>
                            <button 
                                onClick={() => handleAddItem(null)}
                                className="flex-1 bg-stone-700 text-white rounded-md py-3 flex items-center justify-center active:scale-95 transition-transform"
                            >
                                <Plus size={20} />
                                <span className="ml-2 text-sm font-medium">記帳</span>
                            </button>
                        </div>
                    </div>

                    {/* History List */}
                    <div className="space-y-3">
                        {items.length === 0 && (
                            <div className="text-center py-10 text-stone-300">
                                <Wallet size={48} className="mx-auto mb-2 opacity-50" />
                                <p>尚未有消費紀錄</p>
                            </div>
                        )}
                        {items.map((item) => (
                            <div key={item.id} className="card p-3 flex gap-3 items-center">
                                {item.image ? (
                                    <div className="w-12 h-12 bg-stone-100 rounded-md overflow-hidden flex-shrink-0">
                                        <img src={item.image} className="w-full h-full object-cover" />
                                    </div>
                                ) : (
                                    <div className="w-12 h-12 bg-stone-50 rounded-md flex items-center justify-center text-stone-300 flex-shrink-0">
                                        <ShoppingBag size={20} />
                                    </div>
                                )}
                                <div className="flex-1 min-w-0">
                                    <h4 className="font-bold text-stone-700 truncate">{item.name}</h4>
                                    <p className="text-xs text-stone-400">{item.date}</p>
                                </div>
                                <div className="text-right">
                                    <p className="font-mono font-bold text-stone-800">¥{item.amountJPY}</p>
                                    <p className="font-mono text-xs text-stone-400">HK${item.amountHKD}</p>
                                </div>
                                <button 
                                    onClick={() => {
                                        if(confirm('刪除此筆紀錄？')) {
                                            setItems(items.filter(i => i.id !== item.id));
                                        }
                                    }}
                                    className="p-2 text-stone-300 hover:text-red-400"
                                >
                                    <Trash2 size={16} />
                                </button>
                            </div>
                        ))}
                    </div>
                </div>
            );
        };

        // 4. Lists View (清單 & 備忘)
        const ListsView = () => {
            const [checklist, setChecklist] = useState(TRIP_DATA.checklist);
            const [memo, setMemo] = useState("");

            useEffect(() => {
                const savedCheck = localStorage.getItem('tokyo2025_check');
                const savedMemo = localStorage.getItem('tokyo2025_memo');
                if (savedCheck) setChecklist(JSON.parse(savedCheck));
                if (savedMemo) setMemo(savedMemo);
            }, []);

            useEffect(() => {
                localStorage.setItem('tokyo2025_check', JSON.stringify(checklist));
                localStorage.setItem('tokyo2025_memo', memo);
            }, [checklist, memo]);

            const toggleCheck = (id) => {
                setChecklist(checklist.map(item => 
                    item.id === id ? { ...item, checked: !item.checked } : item
                ));
            };

            // Auto-linkify function
            const renderMemo = (text) => {
                const urlRegex = /(https?:\/\/[^\s]+)/g;
                return text.split(urlRegex).map((part, i) => {
                    if (part.match(urlRegex)) {
                        return <a key={i} href={part} target="_blank" className="text-blue-600 underline break-all">{part}</a>;
                    }
                    return part;
                });
            };

            return (
                <div className="px-4 py-6 pb-24 h-full">
                    <h2 className="text-xl font-bold tracking-widest text-stone-700 mb-6">LISTS</h2>

                    {/* Checklist */}
                    <div className="mb-8">
                        <h3 className="text-sm font-bold text-stone-400 mb-3 uppercase tracking-wider">Pre-Trip Check</h3>
                        <div className="card divide-y divide-stone-100">
                            {checklist.map(item => (
                                <div 
                                    key={item.id} 
                                    onClick={() => toggleCheck(item.id)}
                                    className="p-3 flex items-center gap-3 active:bg-stone-50 transition-colors cursor-pointer"
                                >
                                    <div className={`w-5 h-5 rounded border flex items-center justify-center transition-all ${item.checked ? 'bg-stone-600 border-stone-600' : 'border-stone-300'}`}>
                                        {item.checked && <div className="text-white text-xs">✓</div>}
                                    </div>
                                    <span className={`text-sm ${item.checked ? 'text-stone-300 line-through' : 'text-stone-700'}`}>
                                        {item.text}
                                    </span>
                                </div>
                            ))}
                        </div>
                    </div>

                    {/* Memo */}
                    <div className="flex flex-col h-[40vh]">
                        <h3 className="text-sm font-bold text-stone-400 mb-3 uppercase tracking-wider">Memo</h3>
                        <textarea
                            className="card flex-1 w-full p-4 text-sm leading-relaxed focus:outline-none focus:ring-1 focus:ring-stone-300 resize-none font-sans"
                            placeholder="輸入備忘... (網址會自動變成連結)"
                            value={memo}
                            onChange={(e) => setMemo(e.target.value)}
                        />
                        <div className="mt-2 p-2 bg-stone-50 rounded border border-stone-200 text-xs text-stone-500 max-h-20 overflow-y-auto">
                            預覽 (連結可點擊): <br/>
                            <span className="whitespace-pre-wrap">{renderMemo(memo)}</span>
                        </div>
                    </div>
                </div>
            );
        };

        // 5. Info View (資訊)
        const InfoView = () => (
            <div className="px-4 py-6 pb-24">
                 <h2 className="text-xl font-bold tracking-widest text-stone-700 mb-6">INFO</h2>

                 <div className="grid grid-cols-2 gap-4 mb-6">
                    <a href="https://www.jma.go.jp/bosai/forecast/" target="_blank" className="card p-4 flex flex-col items-center justify-center gap-2 hover:bg-stone-50">
                        <Sun size={32} className="text-orange-400" />
                        <span className="text-sm font-bold text-stone-600">天氣預報</span>
                    </a>
                    <a href="https://www.google.com/maps/search/police+station+near+me" target="_blank" className="card p-4 flex flex-col items-center justify-center gap-2 hover:bg-stone-50">
                        <AlertTriangle size={32} className="text-red-400" />
                        <span className="text-sm font-bold text-stone-600">緊急求助</span>
                    </a>
                 </div>

                 <div className="space-y-4">
                    <div className="card p-4 border-l-4 border-red-500">
                        <h3 className="font-bold flex items-center gap-2 text-red-700 mb-2">
                            <Phone size={18} /> 緊急聯絡
                        </h3>
                        <div className="text-sm space-y-2 text-stone-600">
                            <p>警察: <span className="font-mono font-bold">110</span></p>
                            <p>火警/救護車: <span className="font-mono font-bold">119</span></p>
                            <p>台北駐日經濟文化代表處: <br/><span className="font-mono text-xs">03-3280-7111</span></p>
                            <p>香港駐東京經貿辦: <br/><span className="font-mono text-xs">03-3556-8980</span></p>
                        </div>
                    </div>

                     <div className="card p-4">
                        <h3 className="font-bold mb-2 text-stone-700">注意事項</h3>
                        <ul className="list-disc list-inside text-sm text-stone-600 space-y-1">
                            <li>日本電壓 100V (雙平腳插頭)。</li>
                            <li>搭乘手扶梯：東京通常靠左站立。</li>
                            <li>電車內請勿講電話，手機請開靜音。</li>
                            <li>大多餐廳禁帶外食。</li>
                            <li>禁止邊走邊吃 (特別是觀光區)。</li>
                        </ul>
                    </div>
                 </div>
            </div>
        );

        // --- MAIN APP SHELL ---
        const App = () => {
            const [activeTab, setActiveTab] = useState('plan');

            const renderContent = () => {
                switch(activeTab) {
                    case 'plan': return <PlanView />;
                    case 'guide': return <GuideView />;
                    case 'wallet': return <WalletView />;
                    case 'lists': return <ListsView />;
                    case 'info': return <InfoView />;
                    default: return <PlanView />;
                }
            };

            const NavBtn = ({ id, icon: Icon, label }) => (
                <button 
                    onClick={() => setActiveTab(id)}
                    className={`flex flex-col items-center justify-center w-full py-2 transition-colors ${
                        activeTab === id ? 'text-stone-800' : 'text-stone-400'
                    }`}
                >
                    <Icon size={24} strokeWidth={activeTab === id ? 2.5 : 2} />
                    <span className="text-[10px] font-medium mt-1 tracking-wide">{label}</span>
                </button>
            );

            return (
                <div className="max-w-md mx-auto min-h-screen bg-[#f9f9f6] relative shadow-2xl">
                    {/* Content Area */}
                    <div className="min-h-screen">
                        {renderContent()}
                    </div>

                    {/* Bottom Navigation */}
                    <div className="fixed bottom-0 left-0 right-0 max-w-md mx-auto bg-white border-t border-stone-200 safe-bottom z-50">
                        <div className="flex justify-around items-center h-16 px-2">
                            <NavBtn id="plan" icon={Calendar} label="PLAN" />
                            <NavBtn id="guide" icon={MapPin} label="GUIDE" />
                            <NavBtn id="wallet" icon={Wallet} label="WALLET" />
                            <NavBtn id="lists" icon={List} label="LISTS" />
                            <NavBtn id="info" icon={Info} label="INFO" />
                        </div>
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
